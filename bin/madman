#!/usr/bin/env ruby
require 'mister_bin'
require 'madman'
require 'madman/commands'

runner = MisterBin::Runner.new version: Madman::VERSION

runner.route 'nav',     to: Madman::Commands::Nav
runner.route 'preview', to: Madman::Commands::Preview
runner.route 'readme',  to: Madman::Commands::Readme
runner.route 'render',  to: Madman::Commands::Render
runner.route 'serve',   to: Madman::Commands::Serve

begin
  exit runner.run ARGV
rescue => e
  puts e.backtrace.reverse if ENV['DEBUG']
  say! "!txtred!#{e.class}: #{e.message}"
  exit 1
end